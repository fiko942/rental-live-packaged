'use strict';const _0x244768=_0x11f2;(function(_0x18b32c,_0x223e7f){const _0x3648e9=_0x11f2,_0x4fb30e=_0x18b32c();while(!![]){try{const _0x2ee25c=parseInt(_0x3648e9(0x15d))/0x1*(-parseInt(_0x3648e9(0x16f))/0x2)+-parseInt(_0x3648e9(0x151))/0x3+-parseInt(_0x3648e9(0x160))/0x4*(parseInt(_0x3648e9(0x143))/0x5)+parseInt(_0x3648e9(0x171))/0x6+parseInt(_0x3648e9(0x166))/0x7+parseInt(_0x3648e9(0x168))/0x8*(parseInt(_0x3648e9(0x14b))/0x9)+parseInt(_0x3648e9(0x154))/0xa;if(_0x2ee25c===_0x223e7f)break;else _0x4fb30e['push'](_0x4fb30e['shift']());}catch(_0x5b4d8c){_0x4fb30e['push'](_0x4fb30e['shift']());}}}(_0x534e,0xe4c05));function _0x534e(){const _0xd2aa4=['4449752YHNFSi','unix','isValid','next','session','running','pending','167434HLotrU','email','2585766mSjmGv','balance','user','startOf','count','5226030oCLORl','default','database','findOne','generate','userDashboardData','done','INVALID_SESSION','18gxauYY','moment-timezone','uuid','throw','Asia/Jakarta','__esModule','5609358udzrZW','name','__awaiter','24836800BpiWve','balanceHistory','userId','day','change','detail','endOf','sequelize','findAll','19FPUexw','value','defineProperty','4ydUlni','then','userEmail','emailVerified','Failed\x20for\x20generate\x20the\x20session:\x20user\x20was\x20not\x20found','banned','9908507vJmJjE','task'];_0x534e=function(){return _0xd2aa4;};return _0x534e();}var __awaiter=this&&this[_0x244768(0x153)]||function(_0x188d09,_0x339e1b,_0x45efb6,_0x57758d){function _0x24737e(_0xd7f3c3){return _0xd7f3c3 instanceof _0x45efb6?_0xd7f3c3:new _0x45efb6(function(_0x377b8f){_0x377b8f(_0xd7f3c3);});}return new(_0x45efb6||(_0x45efb6=Promise))(function(_0x1fa4b4,_0x52c9b4){const _0x1bc19e=_0x11f2;function _0x52fcff(_0x2d016d){const _0x201b29=_0x11f2;try{_0x57c8c4(_0x57758d[_0x201b29(0x16b)](_0x2d016d));}catch(_0xa6ec4c){_0x52c9b4(_0xa6ec4c);}}function _0x98d92(_0x3373fb){const _0x1b8899=_0x11f2;try{_0x57c8c4(_0x57758d[_0x1b8899(0x14e)](_0x3373fb));}catch(_0x51f4d1){_0x52c9b4(_0x51f4d1);}}function _0x57c8c4(_0x2ac1de){const _0x472cec=_0x11f2;_0x2ac1de[_0x472cec(0x149)]?_0x1fa4b4(_0x2ac1de[_0x472cec(0x15e)]):_0x24737e(_0x2ac1de[_0x472cec(0x15e)])[_0x472cec(0x161)](_0x52fcff,_0x98d92);}_0x57c8c4((_0x57758d=_0x57758d['apply'](_0x188d09,_0x339e1b||[]))[_0x1bc19e(0x16b)]());});},__importDefault=this&&this['__importDefault']||function(_0x133d8f){const _0x35748b=_0x244768;return _0x133d8f&&_0x133d8f[_0x35748b(0x150)]?_0x133d8f:{'default':_0x133d8f};};Object[_0x244768(0x15f)](exports,_0x244768(0x150),{'value':!![]});function _0x11f2(_0x45da44,_0x50d748){const _0x534ea1=_0x534e();return _0x11f2=function(_0x11f218,_0x1a901c){_0x11f218=_0x11f218-0x140;let _0x2ef904=_0x534ea1[_0x11f218];return _0x2ef904;},_0x11f2(_0x45da44,_0x50d748);}const moment_timezone_1=__importDefault(require(_0x244768(0x14c))),uuid_1=require(_0x244768(0x14d)),sequelize_1=require(_0x244768(0x15b));class Session{constructor({database:_0x49d171}){this['database']=_0x49d171;}[_0x244768(0x147)](_0x176da6){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x446392=_0x11f2,_0x8f64ec=yield this['database'][_0x446392(0x140)]['findOne']({'where':{'email':_0x176da6},'attributes':['id']}),_0x3f6bbd=(0x0,moment_timezone_1[_0x446392(0x144)])()['tz'](_0x446392(0x14f))[_0x446392(0x169)]();if(!_0x8f64ec)throw new Error(_0x446392(0x164));const _0x392b29=(0x0,uuid_1['v4'])();return yield this[_0x446392(0x145)][_0x446392(0x16c)]['create']({'userId':_0x8f64ec['id'],'userEmail':_0x176da6,'created':_0x3f6bbd,'hash':_0x392b29,'lastAccessed':_0x3f6bbd,'userAgent':null,'ip':null}),_0x392b29;});}[_0x244768(0x16a)](_0x197933){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x34d529=_0x11f2,_0x1f81d7=yield this[_0x34d529(0x145)][_0x34d529(0x16c)]['findOne']({'where':{'hash':_0x197933},'attributes':[_0x34d529(0x162)]});if(!_0x1f81d7)return![];const _0x4af2f1=yield this[_0x34d529(0x145)][_0x34d529(0x140)][_0x34d529(0x146)]({'where':{'email':_0x1f81d7['userEmail']},'attributes':[_0x34d529(0x165),_0x34d529(0x163)]});if(!_0x4af2f1)return![];if(_0x4af2f1[_0x34d529(0x165)])return![];if(!_0x4af2f1[_0x34d529(0x163)])return![];return!![];});}[_0x244768(0x159)](_0x2f1220){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x23ce31=_0x11f2,_0x1d77bd=yield this[_0x23ce31(0x145)][_0x23ce31(0x16c)]['findOne']({'where':{'hash':_0x2f1220}});if(!_0x1d77bd)throw new Error(_0x23ce31(0x14a));return{'id':_0x1d77bd[_0x23ce31(0x156)],'email':_0x1d77bd[_0x23ce31(0x162)]};});}[_0x244768(0x148)](_0x5933c0){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2ff699=_0x11f2,_0x40d921=yield this[_0x2ff699(0x159)](_0x5933c0),_0x1f6b09=yield this[_0x2ff699(0x145)][_0x2ff699(0x140)][_0x2ff699(0x146)]({'where':{'id':_0x40d921['id'],'email':_0x40d921[_0x2ff699(0x170)]},'attributes':[_0x2ff699(0x170),_0x2ff699(0x152),'balance']});let _0x43fa9c=0x0;const _0x51ac49=(0x0,moment_timezone_1[_0x2ff699(0x144)])()['tz']('Asia/Jakarta')[_0x2ff699(0x141)](_0x2ff699(0x157))[_0x2ff699(0x169)](),_0x4890e9=(0x0,moment_timezone_1['default'])()['tz'](_0x2ff699(0x14f))[_0x2ff699(0x15a)]('day')[_0x2ff699(0x169)](),_0x5a6bb4=yield this['database'][_0x2ff699(0x155)][_0x2ff699(0x15c)]({'where':{'userEmail':_0x40d921[_0x2ff699(0x170)],'userId':_0x40d921['id'],'at':{[sequelize_1['Op']['between']]:[_0x51ac49,_0x4890e9]},'change':{[sequelize_1['Op']['lt']]:0x0}},'attributes':[_0x2ff699(0x158)]});for(const _0x21a785 of _0x5a6bb4){_0x43fa9c+=_0x21a785[_0x2ff699(0x158)];}const _0x226b28=yield this[_0x2ff699(0x145)][_0x2ff699(0x167)][_0x2ff699(0x142)]({'where':{'userEmail':_0x40d921[_0x2ff699(0x170)],'userId':_0x40d921['id'],'statusKey':_0x2ff699(0x16e)}}),_0x27e884=yield this['database'][_0x2ff699(0x167)]['count']({'where':{'userEmail':_0x40d921[_0x2ff699(0x170)],'userId':_0x40d921['id'],'statusKey':_0x2ff699(0x16d),'pid':{[sequelize_1['Op']['not']]:null}}});return{'name':_0x1f6b09['name'],'email':_0x1f6b09[_0x2ff699(0x170)],'runningTask':_0x27e884,'scheduledTask':_0x226b28,'expensesToday':_0x43fa9c,'balance':_0x1f6b09[_0x2ff699(0x172)]};});}}exports[_0x244768(0x144)]=Session;