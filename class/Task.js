'use strict';const _0x206872=_0x5280;function _0xd60f(){const _0x2c02e7=['4bGsAco','kill\x20-9\x20','join','stopped','inherit','default','count','deviceExpirationRuntime','map','flatMap','Task\x20was\x20not\x20found\x20with\x20alias:\x20','403806BYyLNl','1594888IkGJVN','rtmps','file','Process\x20has\x20been\x20killed\x20in\x20before\x20that','granted','tasks','taskAliases','exec','Invalid\x20platform\x20url','configurable','bg-red-500','balance','day','bg-green-500','emit','accessStatus','not','currentLiveIndex','probe','apply','120','platformUrl','create','2163066QsHrbE','exit','push','stringify','running','Error','Streaming\x20berhenti\x20karena\x20proses\x20live\x20sudah\x20selesai','orange','statusTitle','stop','detail','-maxrate','unix','decreaseBalanceRuntime','platformKey','Ping\x20to\x20','userEmail','Merestart','Asia/Jakarta','sequelize','Tugas\x20sedang\x20berjalan','Error\x20pinging\x20','isURL','aliases','Parent\x20process\x20manually\x20disconnected\x20from\x20the\x20child\x20process','scheduleEnabled','value','Process\x20exited\x20with\x20code:\x20','pending','restartAllLiveTasks','throw','IS_DEVELOPMENT','Sedang\x20melakukan\x20restart','next','isInfiniteLoop','trim','36rniSri','storage','defineProperty','killProcess','streamKey','-codec','Proses\x20live\x20dihentikan\x20oleh\x20pengguna','Process\x20was\x20killed\x20with\x20signal:\x20','between','spawnTask','transaction','3846340sBkxWq','1471205Ziulrv','statusKey','libx264','\x20tugas\x20berjalan','restart','addConnection','stats','ping','infiniteLoop','__esModule','fileRepeat','fileAliases','split','root','alias','-preset','pingCheckEveryMinute','update-task','Failed\x20to\x20start\x20process:\x20','filter','endOf','startOf','Tugas\x20berhasil\x20dibuat','hasOwnProperty','alive','sendUpdatedTask','user','getOwnPropertyDescriptor','message','platform','close','Task\x20has\x20been\x20stopped,\x20wait\x20event\x20has\x20been\x20stopped','\x20/F','deposit','96TipdNy','-stream_loop','pid','then','rtmp','done','prototype','-re','string','put','autoPutStat','__createBinding','pricePerMinute','__importDefault','error','329018hYzvUP','log','-b:v','promise','Dibuat','findOne','schedule','parse','task','a.rtmp.youtube.com','endsWith','findAll','\x20failed','destroy','success','socket','absPath','email','update','database','ASC','random','decreasedSaldoByTask','red','enabled','Menunggu\x20Jadwal','autoStopAt','Berjalan','DESC','created','__awaiter','flv','disconnect','child_process','Menunggu\x20tenggat\x20waktu\x20yang\x20sudah\x20terjadwal','shuffle','balanceHistory','spawn','userId','remove','88431VxsErg','statusColor','change','amount','taskCore','uuid','autoStopRuntime','waitUntilTaskScheduled','taskkill\x20/PID\x20','getTotalDecimalTodayStat','task_usage','connections'];_0xd60f=function(){return _0x2c02e7;};return _0xd60f();}(function(_0x5045ea,_0x52f60f){const _0x2c6727=_0x5280,_0x2fc4f5=_0x5045ea();while(!![]){try{const _0x74a841=-parseInt(_0x2c6727(0x1a6))/0x1+parseInt(_0x2c6727(0x12d))/0x2+-parseInt(_0x2c6727(0x145))/0x3+parseInt(_0x2c6727(0x122))/0x4*(-parseInt(_0x2c6727(0x175))/0x5)+parseInt(_0x2c6727(0x197))/0x6*(parseInt(_0x2c6727(0x116))/0x7)+-parseInt(_0x2c6727(0x12e))/0x8+-parseInt(_0x2c6727(0x169))/0x9*(-parseInt(_0x2c6727(0x174))/0xa);if(_0x74a841===_0x52f60f)break;else _0x2fc4f5['push'](_0x2fc4f5['shift']());}catch(_0x237bef){_0x2fc4f5['push'](_0x2fc4f5['shift']());}}}(_0xd60f,0x6164d));function _0x5280(_0x1d7bf7,_0x2c9f25){const _0xd60fb4=_0xd60f();return _0x5280=function(_0x5280c3,_0x34c8f7){_0x5280c3=_0x5280c3-0x10c;let _0x2e7185=_0xd60fb4[_0x5280c3];return _0x2e7185;},_0x5280(_0x1d7bf7,_0x2c9f25);}var __createBinding=this&&this[_0x206872(0x1a2)]||(Object[_0x206872(0x144)]?function(_0x13b6e9,_0x5e6977,_0x163013,_0x6612a){const _0x21d696=_0x206872;if(_0x6612a===undefined)_0x6612a=_0x163013;var _0x134d83=Object[_0x21d696(0x190)](_0x5e6977,_0x163013);(!_0x134d83||('get'in _0x134d83?!_0x5e6977['__esModule']:_0x134d83['writable']||_0x134d83[_0x21d696(0x137)]))&&(_0x134d83={'enumerable':!![],'get':function(){return _0x5e6977[_0x163013];}}),Object[_0x21d696(0x16b)](_0x13b6e9,_0x6612a,_0x134d83);}:function(_0x215778,_0x37970f,_0x8c2865,_0x36abc4){if(_0x36abc4===undefined)_0x36abc4=_0x8c2865;_0x215778[_0x36abc4]=_0x37970f[_0x8c2865];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[_0x206872(0x144)]?function(_0x511001,_0x546801){const _0x402e0e=_0x206872;Object[_0x402e0e(0x16b)](_0x511001,_0x402e0e(0x127),{'enumerable':!![],'value':_0x546801});}:function(_0x327b17,_0x5c8022){const _0x70c139=_0x206872;_0x327b17[_0x70c139(0x127)]=_0x5c8022;}),__importStar=this&&this['__importStar']||function(_0x1fd84a){const _0x497916=_0x206872;if(_0x1fd84a&&_0x1fd84a[_0x497916(0x17e)])return _0x1fd84a;var _0x511878={};if(_0x1fd84a!=null){for(var _0x33c5e3 in _0x1fd84a)if(_0x33c5e3!==_0x497916(0x127)&&Object[_0x497916(0x19d)][_0x497916(0x18c)]['call'](_0x1fd84a,_0x33c5e3))__createBinding(_0x511878,_0x1fd84a,_0x33c5e3);}return __setModuleDefault(_0x511878,_0x1fd84a),_0x511878;},__awaiter=this&&this[_0x206872(0x10c)]||function(_0x2aff34,_0x333227,_0x6eef0c,_0xad59eb){function _0x566205(_0x4aa9f0){return _0x4aa9f0 instanceof _0x6eef0c?_0x4aa9f0:new _0x6eef0c(function(_0x27fe2c){_0x27fe2c(_0x4aa9f0);});}return new(_0x6eef0c||(_0x6eef0c=Promise))(function(_0x2cc8e1,_0x29d174){const _0x7d56c6=_0x5280;function _0x2093cd(_0x1bdbb6){try{_0xe5bb4b(_0xad59eb['next'](_0x1bdbb6));}catch(_0x383083){_0x29d174(_0x383083);}}function _0x5c11e7(_0x2824a5){const _0x1dc6aa=_0x5280;try{_0xe5bb4b(_0xad59eb[_0x1dc6aa(0x163)](_0x2824a5));}catch(_0x5a3fd0){_0x29d174(_0x5a3fd0);}}function _0xe5bb4b(_0x40d098){const _0x3e7629=_0x5280;_0x40d098[_0x3e7629(0x19c)]?_0x2cc8e1(_0x40d098[_0x3e7629(0x15f)]):_0x566205(_0x40d098['value'])[_0x3e7629(0x19a)](_0x2093cd,_0x5c11e7);}_0xe5bb4b((_0xad59eb=_0xad59eb[_0x7d56c6(0x141)](_0x2aff34,_0x333227||[]))[_0x7d56c6(0x166)]());});},__importDefault=this&&this[_0x206872(0x1a4)]||function(_0x424a0f){const _0x57f1cf=_0x206872;return _0x424a0f&&_0x424a0f[_0x57f1cf(0x17e)]?_0x424a0f:{'default':_0x424a0f};};Object[_0x206872(0x16b)](exports,_0x206872(0x17e),{'value':!![]});const uuid_1=require(_0x206872(0x11b)),moment_timezone_1=__importDefault(require('moment-timezone')),child_process_1=require(_0x206872(0x10f)),sequelize_1=require(_0x206872(0x158)),os=__importStar(require('os')),ping_1=__importDefault(require(_0x206872(0x17c))),validator_1=__importDefault(require('validator'));class Task{constructor({database:_0x59f94b,session:_0x4fcc16,storage:_0x40c1fa,balance:_0x4ddf4e,user:_0x27a91e,deviceExpiration:_0x4e779e}){const _0x1aa66e=_0x206872;this['database']=_0x59f94b,this[_0x1aa66e(0x139)]=_0x4ddf4e,this[_0x1aa66e(0x16a)]=_0x40c1fa,this['user']=_0x27a91e,this[_0x1aa66e(0x1a3)]=3.4722,this['session']=_0x4fcc16,this['connections']=[],this['deviceExpiration']=_0x4e779e,!process['env'][_0x1aa66e(0x164)]&&(this[_0x1aa66e(0x162)](),this[_0x1aa66e(0x185)](),this['decreaseBalanceRuntime'](),this[_0x1aa66e(0x1a1)]({'every':0x1b7740})),this[_0x1aa66e(0x11c)]({'delay':0x1b58}),this['deviceExpirationRuntime']();}[_0x206872(0x129)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5b22b0=_0x5280;while(!![]){yield new Promise(_0x3c3af6=>setTimeout(_0x3c3af6,0xea60));try{const _0x3716cd=yield this['deviceExpiration'][_0x5b22b0(0x13d)]();console[_0x5b22b0(0x1a7)](_0x3716cd);if(!_0x3716cd[_0x5b22b0(0x132)]){const _0x43cf40=yield this[_0x5b22b0(0x1b9)][_0x5b22b0(0x1ae)][_0x5b22b0(0x1b1)]({'where':{'statusKey':_0x5b22b0(0x149)},'attributes':['alias']}),_0x2a5fb1=_0x43cf40[_0x5b22b0(0x12a)](_0x48e64e=>_0x48e64e[_0x5b22b0(0x183)]);for(const _0x2eb995 of _0x2a5fb1){yield this[_0x5b22b0(0x14e)](_0x2eb995,'Dihentikan\x20secara\x20otomatis\x20karena\x20lisensi\x20sudah\x20expired');}}}catch(_0x3723bd){console[_0x5b22b0(0x1a5)](_0x3723bd);}}});}[_0x206872(0x11c)](_0x599a60){return __awaiter(this,arguments,void 0x0,function*({delay:_0x988a7f}){const _0x135b3b=_0x5280;while(!![]){try{const _0x15302a=yield this[_0x135b3b(0x1b9)][_0x135b3b(0x1ae)][_0x135b3b(0x1b1)]({'where':{'statusKey':'running'},'attributes':['alias']}),_0x288501=_0x15302a['map'](_0x285cf5=>_0x285cf5[_0x135b3b(0x183)]),_0xfa5c03=(0x0,moment_timezone_1[_0x135b3b(0x127)])()['tz']('Asia/Jakarta')[_0x135b3b(0x151)]();for(const _0x547c06 of _0x288501){const _0x409ae3=yield this[_0x135b3b(0x14f)](_0x547c06);_0x409ae3[_0x135b3b(0x176)]==='running'&&_0x409ae3[_0x135b3b(0x1c0)]!==null&&(_0xfa5c03>_0x409ae3[_0x135b3b(0x1c0)]&&(yield this[_0x135b3b(0x14e)](_0x547c06,'Proses\x20dihentikan\x20secara\x20terjadwal')));}}catch(_0x3074bd){}yield new Promise(_0x1888e7=>setTimeout(_0x1888e7,_0x988a7f));}});}[_0x206872(0x17b)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x36de05=_0x5280;let _0x574bd7=[];const _0x4454e7=[['running',_0x36de05(0x13b)],[_0x36de05(0x125),_0x36de05(0x138)],[_0x36de05(0x161),'bg-yellow-500']];for(const _0x42e941 of _0x4454e7){const _0x566e06=yield this[_0x36de05(0x1b9)][_0x36de05(0x1ae)][_0x36de05(0x128)]({'where':{'statusKey':_0x42e941[0x0]}});_0x574bd7[_0x36de05(0x147)]({'name':_0x42e941[0x0],'count':_0x566e06,'color':_0x42e941[0x1]});}return _0x574bd7;});}[_0x206872(0x1a1)](_0x398657){return __awaiter(this,arguments,void 0x0,function*({every:_0x114285}){const _0x30277c=_0x5280,_0x177bf9=()=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x37ee74=_0x5280,_0x110db1=yield this[_0x37ee74(0x11f)](),_0x3a8810=(0x0,moment_timezone_1['default'])()['tz']('Asia/Jakarta')[_0x37ee74(0x151)]();yield this[_0x37ee74(0x1b9)]['stats'][_0x37ee74(0x144)]({'at':_0x3a8810,'runningTasks':_0x110db1['tasks'][_0x37ee74(0x149)],'stoppedTasks':_0x110db1[_0x37ee74(0x133)][_0x37ee74(0x125)],'pendingTasks':_0x110db1[_0x37ee74(0x133)][_0x37ee74(0x161)],'users':_0x110db1['users'],'deposit':_0x110db1[_0x37ee74(0x196)],'decreasedSaldoByTasks':_0x110db1[_0x37ee74(0x1bc)]});});try{yield _0x177bf9();}catch(_0x53b2e7){console[_0x30277c(0x1a5)](_0x53b2e7);}setInterval(_0x177bf9,_0x114285);});}['pingSite'](_0x51581a,_0x470454){const _0xea198a=()=>{const _0x3ab0a7=_0x5280;ping_1[_0x3ab0a7(0x127)][_0x3ab0a7(0x1a9)][_0x3ab0a7(0x140)](_0x51581a)[_0x3ab0a7(0x19a)](_0x1e2ada=>{const _0x2d77e9=_0x3ab0a7;!_0x1e2ada[_0x2d77e9(0x18d)]?_0x470454(_0x2d77e9(0x154)+_0x51581a+_0x2d77e9(0x1b2)):parseInt(_0x1e2ada['time'])>0x64&&_0x470454('');})['catch'](_0x1a09f1=>{const _0x17cb00=_0x3ab0a7;_0x470454(_0x17cb00(0x15a)+_0x51581a+':\x20'+_0x1a09f1[_0x17cb00(0x191)]);});};_0xea198a(),setInterval(_0xea198a,0x7d0);}['pingCheckEveryMinute'](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x45336f=_0x5280;this['pingSite'](_0x45336f(0x1af),()=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x5f23b8=_0x45336f,_0x3d272f=yield this[_0x5f23b8(0x1b9)][_0x5f23b8(0x1ae)][_0x5f23b8(0x1b1)]({'order':[['created',_0x5f23b8(0x1ba)]],'where':{'pid':{[sequelize_1['Op'][_0x5f23b8(0x13e)]]:null},'statusKey':{[sequelize_1['Op']['in']]:[_0x5f23b8(0x149),'pending']}},'attributes':[_0x5f23b8(0x183)]});for(const _0x24f3c0 of _0x3d272f){this['restart'](_0x24f3c0[_0x5f23b8(0x183)]);}}));});}[_0x206872(0x152)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2c68a0=_0x5280;while(!![]){try{const _0x3133e2=yield this[_0x2c68a0(0x1b9)][_0x2c68a0(0x1ae)][_0x2c68a0(0x1b1)]({'where':{'pid':{[sequelize_1['Op']['not']]:null},'statusKey':_0x2c68a0(0x149)},'attributes':[_0x2c68a0(0x114),'userEmail','alias']});let _0x47974d=[];for(const _0x358530 of _0x3133e2){const _0x597d62=_0x47974d['findIndex'](_0x5cb24c=>_0x5cb24c[_0x2c68a0(0x18f)]['email']===_0x358530['userEmail']&&_0x5cb24c['user']['id']===_0x358530[_0x2c68a0(0x114)]);_0x597d62<0x0?_0x47974d[_0x2c68a0(0x147)]({'user':{'id':_0x358530[_0x2c68a0(0x114)],'email':_0x358530['userEmail']},'count':0x1,'taskAliases':[_0x358530['alias']]}):(_0x47974d[_0x597d62][_0x2c68a0(0x128)]++,_0x47974d[_0x597d62][_0x2c68a0(0x134)]['push'](_0x358530[_0x2c68a0(0x183)]));}for(const _0x4d2986 of _0x47974d){const _0x326c2d=this['pricePerMinute']*_0x4d2986['count'];yield this[_0x2c68a0(0x139)][_0x2c68a0(0x1a0)]({'email':_0x4d2986[_0x2c68a0(0x18f)][_0x2c68a0(0x1b7)],'id':_0x4d2986[_0x2c68a0(0x18f)]['id'],'amount':_0x326c2d-_0x326c2d-_0x326c2d,'title':_0x4d2986[_0x2c68a0(0x128)]+_0x2c68a0(0x178),'description':_0x4d2986[_0x2c68a0(0x134)][_0x2c68a0(0x124)](',\x20'),'type':_0x2c68a0(0x120)});}}catch(_0xfb7295){console[_0x2c68a0(0x1a5)](_0xfb7295);}yield new Promise(_0x2406a3=>setTimeout(_0x2406a3,0xea60));}});}[_0x206872(0x162)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2bfb9a=_0x5280,_0xabec0=yield this['database'][_0x2bfb9a(0x1ae)][_0x2bfb9a(0x1b1)]({'order':[[_0x2bfb9a(0x1c3),_0x2bfb9a(0x1ba)]],'where':{'statusKey':{[sequelize_1['Op']['in']]:[_0x2bfb9a(0x149),_0x2bfb9a(0x161)]}},'attributes':[_0x2bfb9a(0x183)]});for(const _0x48a0fd of _0xabec0){console[_0x2bfb9a(0x1a7)]('Spawning:\x20',_0x48a0fd[_0x2bfb9a(0x183)]),this[_0x2bfb9a(0x172)](_0x48a0fd[_0x2bfb9a(0x183)]);}});}[_0x206872(0x17a)](_0x4bbe2e,_0xa4a94d){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5a6da6=_0x5280;this[_0x5a6da6(0x121)][_0x5a6da6(0x147)]({'user':{'id':0x0,'email':'root'},'socket':_0xa4a94d,'session':_0x4bbe2e});let _0x40c08e={};const _0x5a2718=yield this[_0x5a6da6(0x1b9)]['task'][_0x5a6da6(0x1b1)]({'where':_0x40c08e,'order':[[_0x5a6da6(0x1c3),_0x5a6da6(0x1c2)]],'attributes':[_0x5a6da6(0x183)]});let _0x18f11b=[];for(const _0x29e6a2 of _0x5a2718){_0x18f11b['push'](yield this[_0x5a6da6(0x14f)](_0x29e6a2['alias']));}_0xa4a94d[_0x5a6da6(0x13c)]('all-items',_0x18f11b);});}['removeConnection'](_0x23c623){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5f0279=_0x5280;this[_0x5f0279(0x121)]=this['connections'][_0x5f0279(0x188)](_0x196bf7=>_0x196bf7['socket']['id']!==_0x23c623['id']);});}[_0x206872(0x14f)](_0x588b43){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3c651e=_0x5280,_0x49fe32=yield this[_0x3c651e(0x1b9)][_0x3c651e(0x1ae)][_0x3c651e(0x1ab)]({'where':{'alias':_0x588b43}});if(!_0x49fe32)throw new Error(_0x3c651e(0x12c)+_0x588b43);const _0x4e9a6d={'id':_0x49fe32['id'],'alias':_0x49fe32['alias'],'name':_0x49fe32['name'],'schedule':{'enabled':_0x49fe32[_0x3c651e(0x15e)],'time':_0x49fe32['scheduleTime']},'file':{'shuffle':_0x49fe32['fileShuffle'],'repeat':_0x49fe32[_0x3c651e(0x17f)],'aliases':JSON[_0x3c651e(0x1ad)](_0x49fe32[_0x3c651e(0x180)]),'names':yield this[_0x3c651e(0x16a)]['getFileNames'](JSON[_0x3c651e(0x1ad)](_0x49fe32[_0x3c651e(0x180)]))},'streamKey':_0x49fe32[_0x3c651e(0x16d)],'pid':_0x49fe32[_0x3c651e(0x199)],'status':{'color':_0x49fe32[_0x3c651e(0x117)],'message':_0x49fe32['statusMessage'],'title':_0x49fe32[_0x3c651e(0x14d)]},'statusKey':_0x49fe32[_0x3c651e(0x176)],'created':_0x49fe32['created'],'user':{'email':_0x49fe32[_0x3c651e(0x155)],'id':_0x49fe32[_0x3c651e(0x114)]},'currentLiveFile':_0x49fe32['currentLiveFile'],'currentLiveIndex':_0x49fe32[_0x3c651e(0x13f)],'infiniteLoop':_0x49fe32['infiniteLoop'],'platformKey':_0x49fe32[_0x3c651e(0x153)],'platformUrl':_0x49fe32[_0x3c651e(0x143)],'autoStopAt':_0x49fe32[_0x3c651e(0x1c0)]};return _0x4e9a6d;});}['create'](_0x22f013){return __awaiter(this,arguments,void 0x0,function*({name:_0x34afba,session:_0x55114b,schedule:_0x4659ab,shuffleFile:_0x4e28e8,aliases:_0x431936,streamKey:_0x1377fa,infiniteLoop:_0x23ad0f,platformKey:_0x45b60c,platformUrl:_0x86268a,autoStopAt:_0x304618}){const _0x5057f7=_0x5280;_0x86268a=_0x86268a[_0x5057f7(0x168)]()[_0x5057f7(0x181)]('?')[0x0];if(!validator_1['default'][_0x5057f7(0x15b)](_0x86268a,{'protocols':[_0x5057f7(0x19b),_0x5057f7(0x12f)]}))throw new Error(_0x5057f7(0x136));!_0x86268a[_0x5057f7(0x1b0)]('/')&&(_0x86268a+='/');typeof _0x304618!=='number'&&(_0x304618=null);const _0x5d30c5=(0x0,uuid_1['v4'])(),_0x26f83a=(0x0,moment_timezone_1['default'])()['tz'](_0x5057f7(0x157));yield this[_0x5057f7(0x1b9)][_0x5057f7(0x1ae)][_0x5057f7(0x144)]({'name':_0x34afba,'alias':_0x5d30c5,'scheduleEnabled':_0x4659ab!==null,'scheduleTime':_0x4659ab,'fileShuffle':_0x4e28e8,'fileRepeat':0x1,'fileAliases':JSON[_0x5057f7(0x148)](_0x431936),'streamKey':_0x1377fa,'pid':null,'statusColor':_0x5057f7(0x14c),'statusMessage':_0x5057f7(0x18b),'statusTitle':_0x5057f7(0x1aa),'statusKey':'stopped','created':_0x26f83a[_0x5057f7(0x151)](),'userId':0x0,'userEmail':_0x5057f7(0x182),'currentLiveFile':null,'currentLiveIndex':0x0,'infiniteLoop':_0x23ad0f,'platformKey':_0x45b60c,'platformUrl':_0x86268a,'autoStopAt':_0x304618});const _0x74e03=yield this['detail'](_0x5d30c5),_0x1ba516=this[_0x5057f7(0x121)];for(const _0x5dfc5d of _0x1ba516){try{_0x5dfc5d[_0x5057f7(0x1b5)]['emit']('new-task',_0x74e03);}catch(_0x7ba4dd){}}this[_0x5057f7(0x172)](_0x5d30c5);});}[_0x206872(0x18e)](_0x5678e7){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x18349b=_0x5280,_0x47eaf7=yield this[_0x18349b(0x14f)](_0x5678e7),_0x532c33=this[_0x18349b(0x121)][_0x18349b(0x188)](_0x455b48=>_0x455b48[_0x18349b(0x18f)]['id']===_0x47eaf7[_0x18349b(0x18f)]['id']&&_0x455b48[_0x18349b(0x18f)]['email']===_0x47eaf7[_0x18349b(0x18f)][_0x18349b(0x1b7)]);for(const _0x12904d of _0x532c33){try{_0x12904d[_0x18349b(0x1b5)][_0x18349b(0x13c)](_0x18349b(0x186),_0x47eaf7);}catch(_0x4bf25d){}}});}['taskCore'](_0x176cdf,_0x2f8f1b){return __awaiter(this,arguments,void 0x0,function*(_0x2222c2,_0x264943,_0x258bde=()=>{}){const _0x20f3d6=_0x5280,_0x57280c=0xc8,_0xc1c303=yield this[_0x20f3d6(0x14f)](_0x2222c2),_0xfd6b58=''+_0xc1c303[_0x20f3d6(0x143)]+_0xc1c303[_0x20f3d6(0x16d)],_0x2f583a=yield this[_0x20f3d6(0x16a)][_0x20f3d6(0x1b6)](_0x264943),_0x7c6136=[_0x20f3d6(0x19e),_0x20f3d6(0x198),'1','-i',_0x2f583a,'-c:v',_0x20f3d6(0x177),_0x20f3d6(0x1a8),_0x57280c/0x3e8+'k',_0x20f3d6(0x150),_0x57280c/0x3e8+'k','-bufsize',_0x57280c/0x3e8+'k',_0x20f3d6(0x184),'verifast',_0x20f3d6(0x16e),'copy','-f',_0x20f3d6(0x10d),'-g',_0x20f3d6(0x142),_0xfd6b58];console[_0x20f3d6(0x1a7)](_0x7c6136[_0x20f3d6(0x124)]('\x20'));const _0x5fa1fd=(0x0,child_process_1[_0x20f3d6(0x113)])('ffmpeg',_0x7c6136,{'stdio':_0x20f3d6(0x126),'detached':!![]});return new Promise(_0x10d998=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x166544=_0x20f3d6;_0x5fa1fd['on'](_0x166544(0x146),(_0x5c6a68,_0x51d928)=>{const _0x3ab743=_0x166544;_0x5c6a68!==null&&(console[_0x3ab743(0x1a5)](_0x3ab743(0x160)+_0x5c6a68),_0x10d998()),_0x51d928!==null&&(console[_0x3ab743(0x1a5)](_0x3ab743(0x170)+_0x51d928),_0x10d998());}),_0x5fa1fd['on'](_0x166544(0x10e),()=>_0x10d998()),_0x5fa1fd['on'](_0x166544(0x1a5),_0x864030=>{const _0x53b7e8=_0x166544;console[_0x53b7e8(0x1a5)](_0x53b7e8(0x187)+_0x864030[_0x53b7e8(0x191)]),_0x10d998();}),_0x5fa1fd['on'](_0x166544(0x193),_0x4edee5=>{const _0x3bec6b=_0x166544;console[_0x3bec6b(0x1a5)](_0x3bec6b(0x160)+_0x4edee5),_0x10d998();}),_0x5fa1fd['on'](_0x166544(0x10e),()=>{const _0x5c79fd=_0x166544;console[_0x5c79fd(0x1a5)](_0x5c79fd(0x15d)),_0x10d998();}),_0x5fa1fd['on'](_0x166544(0x191),console[_0x166544(0x1a7)]),_0x258bde(_0x5fa1fd[_0x166544(0x199)]);}));});}[_0x206872(0x11d)](_0x272238,_0x3539a2){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x25e1b9=_0x5280;yield this['database'][_0x25e1b9(0x1ae)]['update']({'statusKey':_0x25e1b9(0x161),'statusTitle':_0x25e1b9(0x1bf),'statusMessage':_0x25e1b9(0x110),'statusColor':_0x25e1b9(0x14c)},{'where':{'alias':_0x3539a2}}),yield this[_0x25e1b9(0x18e)](_0x3539a2);while(!![]){const _0x3750ea=(0x0,moment_timezone_1['default'])()['tz'](_0x25e1b9(0x157))[_0x25e1b9(0x151)]();if(_0x3750ea>=_0x272238)return;yield new Promise(_0x4cbc5e=>setTimeout(_0x4cbc5e,0x1f40));const _0x5d0eb0=yield this[_0x25e1b9(0x14f)](_0x3539a2);if(_0x5d0eb0[_0x25e1b9(0x176)]===_0x25e1b9(0x125))throw new Error(_0x25e1b9(0x194));}});}['isInfiniteLoop'](_0x1fd5ac){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3e13b4=_0x5280,_0x3768fb=yield this['database']['task'][_0x3e13b4(0x1ab)]({'where':{'alias':_0x1fd5ac},'attributes':['infiniteLoop']});if(!_0x3768fb)return![];return _0x3768fb[_0x3e13b4(0x17d)];});}[_0x206872(0x172)](_0x1e5329){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x47912e=_0x5280;try{let _0xa5b6bd=yield this[_0x47912e(0x14f)](_0x1e5329);_0xa5b6bd[_0x47912e(0x1ac)][_0x47912e(0x1be)]&&(yield this['waitUntilTaskScheduled'](_0xa5b6bd['schedule']['time'],_0x1e5329));yield this[_0x47912e(0x1b9)][_0x47912e(0x1ae)][_0x47912e(0x1b8)]({'statusKey':'running'},{'where':{'alias':_0x1e5329}}),yield this['sendUpdatedTask'](_0x1e5329);let _0x6747f8=_0xa5b6bd['file'][_0x47912e(0x15c)];_0xa5b6bd[_0x47912e(0x130)][_0x47912e(0x111)]&&(_0x6747f8=[...Array(0x1)][_0x47912e(0x12b)](()=>_0x6747f8)['sort'](()=>Math[_0x47912e(0x1bb)]()-0.5));do{try{const _0xcff1ca=yield this[_0x47912e(0x14f)](_0x1e5329);if(_0xcff1ca[_0x47912e(0x176)]===_0x47912e(0x125))return;const _0x32eea5=_0x6747f8[_0xcff1ca[_0x47912e(0x13f)]];if(typeof _0x32eea5===_0x47912e(0x19f)){let _0x17b0bd=null;yield this[_0x47912e(0x11a)](_0x1e5329,_0x32eea5,_0x4d457a=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x56911b=_0x47912e;_0x17b0bd=_0x4d457a,yield this[_0x56911b(0x1b9)][_0x56911b(0x1ae)][_0x56911b(0x1b8)]({'pid':_0x4d457a,'statusColor':'green','statusMessage':'Streaming\x20sedang\x20berjalan','statusTitle':_0x56911b(0x1c1),'statusKey':_0x56911b(0x149),'currentLiveFile':_0x32eea5,'currentLiveIndex':_0xcff1ca[_0x56911b(0x13f)]},{'where':{'alias':_0x1e5329}}),yield this[_0x56911b(0x18e)](_0x1e5329);}));if(_0x17b0bd!==null)try{yield this['killProcess'](_0x17b0bd);}catch(_0x20ae92){}yield this[_0x47912e(0x1b9)][_0x47912e(0x1ae)]['update']({'currentLiveIndex':_0xcff1ca['currentLiveIndex']+0x1,'currentLiveFile':_0x6747f8[_0xcff1ca[_0x47912e(0x13f)]+0x1]},{'where':{'alias':_0x1e5329}}),_0xa5b6bd[_0x47912e(0x13f)]++,yield this[_0x47912e(0x18e)](_0x1e5329);}else yield this['database'][_0x47912e(0x1ae)][_0x47912e(0x1b8)]({'currentLiveIndex':0x0},{'where':{'alias':_0x1e5329}}),yield this[_0x47912e(0x18e)](_0x1e5329);}catch(_0x140d8a){}}while(yield this[_0x47912e(0x167)](_0x1e5329));!(yield this[_0x47912e(0x167)](_0x1e5329))&&(yield this[_0x47912e(0x1b9)][_0x47912e(0x1ae)][_0x47912e(0x1b8)]({'statusKey':_0x47912e(0x125),'statusTitle':'Berhenti','statusMessage':_0x47912e(0x14b),'statusColor':_0x47912e(0x1bd),'pid':null},{'where':{'alias':_0x1e5329}}),yield this[_0x47912e(0x18e)](_0x1e5329));}catch(_0x5c266d){const _0x5de186=yield this[_0x47912e(0x14f)](_0x1e5329);try{_0x5de186['pid']&&(yield this[_0x47912e(0x16c)](_0x5de186[_0x47912e(0x199)]));}catch(_0xf5583b){}yield this[_0x47912e(0x1b9)][_0x47912e(0x1ae)]['update']({'statusKey':'stopped','statusTitle':_0x47912e(0x14a),'statusMessage':''+(_0x5c266d['message']?_0x5c266d['message']:_0x5c266d),'statusColor':_0x47912e(0x1bd),'pid':null},{'where':{'alias':_0x1e5329}}),yield this[_0x47912e(0x18e)](_0x1e5329);}});}[_0x206872(0x16c)](_0x342c43){return new Promise((_0x2cc194,_0xf6ceaa)=>{const _0x2dd05e=_0x5280,_0x2b5aa6=os[_0x2dd05e(0x192)]();let _0x12e886;_0x2b5aa6==='win32'?_0x12e886=_0x2dd05e(0x11e)+_0x342c43+_0x2dd05e(0x195):_0x12e886=_0x2dd05e(0x123)+_0x342c43,(0x0,child_process_1[_0x2dd05e(0x135)])(_0x12e886,(_0x4f6332,_0x8ddc10,_0x12ab90)=>{_0x4f6332?_0xf6ceaa('Error\x20killing\x20process:\x20'+_0x12ab90):_0x2cc194();});});}[_0x206872(0x14e)](_0x3ce7f6){const _0x2851b3=_0x206872;return __awaiter(this,arguments,void 0x0,function*(_0x4fd095,_0xf602ef=_0x2851b3(0x16f)){const _0x3e7284=_0x2851b3,_0x37e603=yield this['detail'](_0x4fd095);try{if(_0x37e603[_0x3e7284(0x199)]===null)throw new Error(_0x3e7284(0x131));yield this[_0x3e7284(0x16c)](_0x37e603[_0x3e7284(0x199)]);}catch(_0x452025){console[_0x3e7284(0x1a5)](_0x452025['message']||_0x452025);}yield this[_0x3e7284(0x1b9)][_0x3e7284(0x1ae)][_0x3e7284(0x1b8)]({'statusKey':'stopped','statusTitle':'Berhenti','statusMessage':_0xf602ef,'statusColor':_0x3e7284(0x1bd),'pid':null},{'where':{'alias':_0x4fd095}}),yield this['sendUpdatedTask'](_0x4fd095);});}['start'](_0x429e4c){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3b6a85=_0x5280,_0x500aac=yield this[_0x3b6a85(0x14f)](_0x429e4c);if(_0x500aac[_0x3b6a85(0x176)]!==_0x3b6a85(0x125))throw new Error(_0x3b6a85(0x159));yield this['database'][_0x3b6a85(0x1ae)]['update']({'statusKey':'running'},{'where':{'alias':_0x429e4c}}),this[_0x3b6a85(0x172)](_0x429e4c);});}[_0x206872(0x179)](_0x2f9b0d){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5834fd=_0x5280,_0x3f081d=yield this['detail'](_0x2f9b0d);if(_0x3f081d[_0x5834fd(0x176)]!==_0x5834fd(0x125))return;yield this[_0x5834fd(0x14e)](_0x2f9b0d),yield this[_0x5834fd(0x1b9)][_0x5834fd(0x1ae)][_0x5834fd(0x1b8)]({'statusKey':'restarting','statusTitle':_0x5834fd(0x156),'statusMessage':_0x5834fd(0x165),'pid':null,'currentLiveFile':null,'currentLiveIndex':0x0},{'where':{'alias':_0x2f9b0d}}),yield this['sendUpdatedTask'](_0x2f9b0d),yield new Promise(_0x2b4890=>setTimeout(_0x2b4890,0x1388)),yield this['spawnTask'](_0x2f9b0d);});}[_0x206872(0x115)](_0x28a0c9,_0x24493b){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2e0788=_0x5280;yield this[_0x2e0788(0x1b9)][_0x2e0788(0x1ae)][_0x2e0788(0x1b3)]({'where':{'alias':_0x28a0c9}});});}[_0x206872(0x11f)](){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x53d426=_0x5280,_0x3390de=(0x0,moment_timezone_1[_0x53d426(0x127)])()['tz'](_0x53d426(0x157))[_0x53d426(0x18a)](_0x53d426(0x13a))[_0x53d426(0x151)](),_0x1a11fb=(0x0,moment_timezone_1[_0x53d426(0x127)])()['tz'](_0x53d426(0x157))[_0x53d426(0x189)](_0x53d426(0x13a))[_0x53d426(0x151)](),_0x32ba56=yield this[_0x53d426(0x1b9)][_0x53d426(0x1ae)][_0x53d426(0x128)]({'where':{'pid':{[sequelize_1['Op'][_0x53d426(0x13e)]]:null},'statusKey':_0x53d426(0x149)}}),_0x3f61fe=yield this[_0x53d426(0x1b9)][_0x53d426(0x1ae)]['count']({'where':{'pid':null,'statusKey':_0x53d426(0x125)}}),_0x5d9a8b=yield this[_0x53d426(0x1b9)][_0x53d426(0x1ae)][_0x53d426(0x128)]({'where':{'pid':null,'statusKey':_0x53d426(0x161)}}),_0x4a58a9=yield this[_0x53d426(0x1b9)][_0x53d426(0x18f)]['count']();let _0x1a8d95=0x0;const _0x5b9032=yield this[_0x53d426(0x1b9)][_0x53d426(0x173)][_0x53d426(0x1b1)]({'where':{'created':{[sequelize_1['Op'][_0x53d426(0x171)]]:[_0x3390de,_0x1a11fb]},'status':_0x53d426(0x1b4)},'attributes':['amount']});for(const _0x2a39d7 of _0x5b9032){_0x1a8d95+=_0x2a39d7[_0x53d426(0x119)];}let _0x5da8fd=0x0;const _0x43967a=yield this[_0x53d426(0x1b9)][_0x53d426(0x112)][_0x53d426(0x1b1)]({'where':{'at':{[sequelize_1['Op'][_0x53d426(0x171)]]:[_0x3390de,_0x1a11fb]}},'attributes':['change']});for(const _0x293fbf of _0x43967a){_0x5da8fd+=_0x293fbf[_0x53d426(0x118)];}return _0x5da8fd=_0x5da8fd-_0x5da8fd-_0x5da8fd,{'tasks':{'running':_0x32ba56,'pending':_0x5d9a8b,'stopped':_0x3f61fe},'users':_0x4a58a9,'deposit':_0x1a8d95,'decreasedSaldoByTask':_0x5da8fd};});}}exports['default']=Task;